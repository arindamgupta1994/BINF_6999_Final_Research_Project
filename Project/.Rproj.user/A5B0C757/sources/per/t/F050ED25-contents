example <- data.frame(
  Yield        = c(50, 55, 60, 48, 52, 57),   
  Variety.Name = factor(c("A", "A", "B", "B", "C", "C")),
  EI           = c(0.20, 0.25, 0.30, 0.32, 0.27, 0.29)
)
example

all_levels <- levels(example$Variety.Name)  


train_df <- example[1:4, ]   # varieties A & B only
test_df  <- example[5:6, ]   # varieties C only

levels(train_df$Variety.Name)   # A B C  (all three still present)

lm_EI <- lm(Yield ~ EI * Variety.Name, data = train_df)

lm_EI$xlevels$Variety.Name
# [1] "A" "B"        --> C is gone

predict(lm_EI, newdata = test_df)
# Error: factor Variety.Name has new levels C



3 options that can potentiall work:
  
 1. Fit on a dataset that has every Variety.Name
    - Add a dummy row per missing variety, give it any numeric EI value, set Yield = NA or 0 and fit with weights = 0 so it   doesnt affect the model fit


2. Use a mixed effect model and treat variety as random


3. use another package (feols, a high performance linear model function from fixest package) to fit LMs that doesnt drop unseen varieties automatically upon fitting.
